

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Visualizing Data in Python &#8212; Python for Experimental Chemistry</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'plotting';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Best Fits in Python" href="lmfit.html" />
    <link rel="prev" title="Data Manipulation &amp; Analysis in Python" href="ManipulatingData.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Python for Experimental Chemistry - Home"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="Python for Experimental Chemistry - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Python for Physical Chemistry
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="ImportingData.html">Importing Data into Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="ManipulatingData.html">Data Manipulation &amp; Analysis in Python</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Visualizing Data in Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="lmfit.html">Best Fits in Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="lab_tutorial.html">(CHM223) Rotational-Vibrational Spectroscopy - Theory</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/Rees9/Py4PhysChem" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/Rees9/Py4PhysChem/issues/new?title=Issue%20on%20page%20%2Fplotting.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/plotting.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Visualizing Data in Python</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-in-python-matplotlib">Plotting in Python: matplotlib</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#annotating-your-plot-plt-annotate">Annotating your plot: plt.annotate()</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alternative-scale-plots-log-inverse-etc">Alternative scale plots: log, inverse, etc</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="visualizing-data-in-python">
<h1>Visualizing Data in Python<a class="headerlink" href="#visualizing-data-in-python" title="Permalink to this heading">#</a></h1>
<section id="plotting-in-python-matplotlib">
<h2>Plotting in Python: matplotlib<a class="headerlink" href="#plotting-in-python-matplotlib" title="Permalink to this heading">#</a></h2>
<p>We can collect and import data, but it is often much more enlightening to present our results in plots rather than tables, so let’s discuss basic plotting in Python with experimental data. For simplicity, that we will assume we are starting with some nice, tabulated data in Python (If not, see the sections Importing and the Manipulating data!)</p>
<p>Specifically, let’s look at the following data, which tracks the concentrations of reactants and products during the hydrolysis of aspirin. <a class="reference external" href="https://saylordotorg.github.io/text_general-chemistry-principles-patterns-and-applications-v1.0/s18-02-reaction-rates-and-rate-laws.html">Data obtained online from here</a>. Speaking broadly, you can see that, over some hours, the concentration of aspirin (acetylsalicylic acid) is decreasing, and the concentration of the salicylic acid product is increasing.</p>
<figure class="align-default">
<a class="reference internal image-reference" href="_images/hydrolysis_aspirin.jpg"><img alt="_images/hydrolysis_aspirin.jpg" src="_images/hydrolysis_aspirin.jpg" style="width: 600px;" /></a>
</figure>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Time (h)</p></th>
<th class="head"><p>[Aspirin] (M)</p></th>
<th class="head"><p>[Salicylic Acid] (M)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>5.55 × 10<sup>−3</sup></p></td>
<td><p>0</p></td>
</tr>
<tr class="row-odd"><td><p>2.0</p></td>
<td><p>5.51 × 10<sup>−3</sup></p></td>
<td><p>0.040 × 10<sup>−3</sup></p></td>
</tr>
<tr class="row-even"><td><p>5.0</p></td>
<td><p>5.45 × 10<sup>−3</sup></p></td>
<td><p>0.10 × 10<sup>−3</sup></p></td>
</tr>
<tr class="row-odd"><td><p>10</p></td>
<td><p>5.35 × 10<sup>−3</sup></p></td>
<td><p>0.20 × 10<sup>−3</sup></p></td>
</tr>
<tr class="row-even"><td><p>20</p></td>
<td><p>5.15 × 10<sup>−3</sup></p></td>
<td><p>0.40 × 10<sup>−3</sup></p></td>
</tr>
<tr class="row-odd"><td><p>30</p></td>
<td><p>4.96 × 10<sup>−3</sup></p></td>
<td><p>0.59 × 10<sup>−3</sup></p></td>
</tr>
<tr class="row-even"><td><p>40</p></td>
<td><p>4.78 × 10<sup>−3</sup></p></td>
<td><p>0.77 × 10<sup>−3</sup></p></td>
</tr>
<tr class="row-odd"><td><p>50</p></td>
<td><p>4.61 × 10<sup>−3</sup></p></td>
<td><p>0.94 × 10<sup>−3</sup></p></td>
</tr>
<tr class="row-even"><td><p>100</p></td>
<td><p>3.83 × 10<sup>−3</sup></p></td>
<td><p>1.72 × 10<sup>−3</sup></p></td>
</tr>
<tr class="row-odd"><td><p>200</p></td>
<td><p>2.64 × 10<sup>−3</sup></p></td>
<td><p>2.91 × 10<sup>−3</sup></p></td>
</tr>
<tr class="row-even"><td><p>300</p></td>
<td><p>1.82 × 10<sup>−3</sup></p></td>
<td><p>3.73 × 10<sup>−3</sup></p></td>
</tr>
</tbody>
</table>
<p>First, as always when coding, we start by importing our packages. Then, we will import our data from the <code class="docutils literal notranslate"><span class="pre">*.txt</span></code> file where it’s stored.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import packages</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline # Plot in the notebook

<span class="n">time</span><span class="p">,</span> <span class="n">conc_aspirin</span><span class="p">,</span> <span class="n">conc_acid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="s1">&#39;data/aspirin_data.txt&#39;</span><span class="p">,</span><span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">skip_header</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">unpack</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>UsageError: unrecognized arguments: # Plot in the notebook
</pre></div>
</div>
</div>
</div>
<p>Now what we imported before was matplotlib.pyplot and labelled it plt. Therefore, we can use all the built-in functionality of the package matplotlib.pyplot easily.</p>
<p>First and foremost, we can simply call <code class="docutils literal notranslate"><span class="pre">plt.plot(x_array,y_array)</span></code> to do a quick plot. We can do this as many times as we want in a single cell to plot multiple arrays on a single graph. Here, we can plot the decreasing concentration of aspirin, and the increasing concentration of salicylic acid.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plotting data</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span><span class="n">conc_aspirin</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span><span class="n">conc_acid</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/df1b5578690d9261e359e1f35b3a73915115e21e73caa65449bb46adafe57ca4.png" src="_images/df1b5578690d9261e359e1f35b3a73915115e21e73caa65449bb46adafe57ca4.png" />
</div>
</div>
<p>You’ll have noticed that the result was a line plot. This is most appropriate for a continuous function, such as a theoretical model. Usually, for discrete data, is it more appropriate to use a scatter plot. We can achieve this by calling <code class="docutils literal notranslate"><span class="pre">plt.scatter</span></code> instead:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plotting data</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">time</span><span class="p">,</span><span class="n">conc_aspirin</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">time</span><span class="p">,</span><span class="n">conc_acid</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.PathCollection at 0x1f225f4bca0&gt;
</pre></div>
</div>
<img alt="_images/903a4d84d769126f534e329a99cb59fde04431020ee96385de329e3c5cc6218a.png" src="_images/903a4d84d769126f534e329a99cb59fde04431020ee96385de329e3c5cc6218a.png" />
</div>
</div>
<p>And thats all we need to do to plot our data! In day-to-day research, we generate quick plots like these <em>all the time</em> to inspect experimental results, and verify the results of steps in post-processing. What’s convenient about <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> is that it, by default, can generate limits, ranges, and tick positions of interest for us automatically in these quick plots.</p>
<p>Obviously though, we are missing many visual elements that could help us better communicate the meaning of our data. Titles, axes labels, legends, etc. can all play vital roles in telling our scientific story, and we can add those by adding additional lines to the simple code listed above. See below:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plot our data and label</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span><span class="n">conc_aspirin</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Aspirin&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span><span class="n">conc_acid</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Salicyclic Acid&#39;</span><span class="p">)</span>
<span class="c1"># label x and y axis</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (hr)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Concentration (M)&#39;</span><span class="p">)</span>
<span class="c1"># create plot title</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Aspirin Hydrolysis in an Aqueous Solution at pH 7.0 and 37 C&#39;</span><span class="p">)</span>

<span class="c1"># set x and y axis limits</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">top</span><span class="o">=</span><span class="mf">0.006</span><span class="p">)</span>
<span class="c1"># create legend</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/c9fc5df7a21ab44036875552a994c94ed330c5c913d2e1656bb970dcca64e017.png" src="_images/c9fc5df7a21ab44036875552a994c94ed330c5c913d2e1656bb970dcca64e017.png" />
</div>
</div>
<p>You can now see how this more publication-quality plot contains some additional information that would give context to the average reader. The view presented could be tailored to highlight a partiuclar aspect, for instance the behaviour in the first 300h, as we show here. The adage ‘a picture is worth a thousand words’ is meaninful in science, it can be worth the time to think about how best to present some data to allow the reader to evaluate (and hopefully accept!) your particular hypothesis.
Lastly we are also not restricted to line graphs, and there are countless options for visual elements to add/modify such as colors, linesizes, linestyles, etc. Very extensive instructions can be found online <a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.plot.html">in the official matplotlib documentation</a>. However, we’ll give a quick example to highlight some useful options:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plotting data, but with more options</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span><span class="n">conc_aspirin</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Aspirin&#39;</span><span class="p">)</span> <span class="c1"># linestyle is the type of line, linewidth is the thickness of the line</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span><span class="n">conc_acid</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Salicyclic Acid&#39;</span><span class="p">)</span>

<span class="c1"># we can also do a scatterplot to highlight the data points</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">time</span><span class="p">,</span><span class="n">conc_aspirin</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span> <span class="c1"># marker is the shape of the data point, s is the size</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">time</span><span class="p">,</span><span class="n">conc_acid</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>

<span class="c1"># label x and y axis</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;time (s)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;concentration (M)&#39;</span><span class="p">)</span>
<span class="c1"># create plot title</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Aspirin Hydrolysis in an Aqueous Solution at pH 7.0 and 37 C&#39;</span><span class="p">)</span>

<span class="c1"># set x and y axis limits</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
<span class="c1"># generate legend</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/fa92a263cb40012ef03f9c3a7da094303b270726c9757641eb41125a429956c1.png" src="_images/fa92a263cb40012ef03f9c3a7da094303b270726c9757641eb41125a429956c1.png" />
</div>
</div>
<p>You can see that we’re able to e.g. change linestyles, colours, and markers, which can all help make relevant aspects clear and accessible to all readers.</p>
</section>
<section id="annotating-your-plot-plt-annotate">
<h2>Annotating your plot: plt.annotate()<a class="headerlink" href="#annotating-your-plot-plt-annotate" title="Permalink to this heading">#</a></h2>
<div class="important admonition">
<p class="admonition-title">For CHM223 students</p>
<p>This subsection is relevant for your assignment!</p>
</div>
<p>Additionally, Python allows us to <em>programatically</em> annotate our plots—automatically add additional text that can help our reader. This is useful if we want to add a label to a specific point on our plot, or if we want to add a label to a specific line on our plot. We can do this using the <code class="docutils literal notranslate"><span class="pre">plt.annotate()</span></code> function.</p>
<p>This function takes four arguments: the text (string) that we want to add, the co-ordinates (x,y) of the data point that we’re looking to draw attention to, and second (optional) set of co-ordinates (xtext,ytext) where we want text itself to be located—particularly if we want to offset it a bit (or just include extra information somewhere else in the plot!) and, lastly, the colour of the text. A nice additional feature is that we can instruct the program to draw an arrow from the text to the particular data point as emphasis! We include an example that uses all of these features below:</p>
<p><code class="docutils literal notranslate"><span class="pre">plt.annotate('text</span> <span class="pre">goes</span> <span class="pre">here',xy=(xvalue,yvalue),xytext=(xfortext,yfortext),color='color')</span></code></p>
<p>For example, if we want to label the point where the first data points where the concentrations cross over and add the text “more acid starting here” to the point (200,0.004) on our plot, we can do so using the following code:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plotting data, but with more options</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span><span class="n">conc_aspirin</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Aspirin&#39;</span><span class="p">)</span> <span class="c1"># linestyle is the type of line, linewidth is the thickness of the line</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span><span class="n">conc_acid</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Salicyclic Acid&#39;</span><span class="p">)</span>

<span class="c1"># we can also do a scatterplot to highlight the data points</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">time</span><span class="p">,</span><span class="n">conc_aspirin</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span> <span class="c1"># marker is the shape of the data point, s is the size</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">time</span><span class="p">,</span><span class="n">conc_acid</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>

<span class="c1"># label x and y axis</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;time (s)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;concentration (M)&#39;</span><span class="p">)</span>
<span class="c1"># create plot title</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Aspirin Hydrolysis in an Aqueous Solution at pH 7.0 and 37 C&#39;</span><span class="p">)</span>

<span class="c1"># set x and y axis limits</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
<span class="c1"># generate legend</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1"># annotate the plot with text</span>
<span class="c1">#xy is the position of the data point, xytext is the position of the text.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;Aspirin&#39;</span><span class="p">,</span><span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mf">0.005</span><span class="p">),</span><span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mf">0.004</span><span class="p">),</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;Salicyclic Acid&#39;</span><span class="p">,</span><span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mf">0.0005</span><span class="p">),</span><span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mf">0.001</span><span class="p">),</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="c1"># annotate the first data points after crossing over</span>
<span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;More acid starting here&#39;</span><span class="p">,</span><span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span><span class="mf">0.003</span><span class="p">),</span><span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span><span class="mf">0.004</span><span class="p">),</span><span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">));</span>
<span class="c1"># arrow will point from text position xytext to data point xy by adding arrowprop part!</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/edda2fca4e7487ff7a2de2fc2b622cc544204d1d63c3feee82f381ae98377b75.png" src="_images/edda2fca4e7487ff7a2de2fc2b622cc544204d1d63c3feee82f381ae98377b75.png" />
</div>
</div>
<p>Remember that each of these ‘co-ordinates’ could also be calculated from the data, which can be especially useful to define regions in our graph after automatically locating certain positions, extrema, or values in our data. For example, here, we manually labelled the crossover point. However, if determining this for an unknown data set was particularly relevant, we could write code to find the first data point where <code class="docutils literal notranslate"><span class="pre">conc_acid</span> <span class="pre">&gt;</span> <span class="pre">conc_aspirin</span></code>, and then include a line to add text (e.g. “more acid starting here”) at that point on our plot.</p>
</section>
<section id="alternative-scale-plots-log-inverse-etc">
<h2>Alternative scale plots: log, inverse, etc<a class="headerlink" href="#alternative-scale-plots-log-inverse-etc" title="Permalink to this heading">#</a></h2>
<p>matplotlib has built-in axis scalings based on how you would like to present your data. For instance, you’ll recall from first year that we can determine a reaction order by generating a few types of plots with customized axes. For a first-order reaction, we are interested in the logarithm of our concentration data. We can easily change the vertical axis to a logaritmic scale using the <code class="docutils literal notranslate"><span class="pre">plt.yscale()</span></code> command as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plot our data and label</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">conc_aspirin</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Aspirin&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">conc_acid</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Salicyclic Acid&#39;</span><span class="p">)</span>

<span class="c1"># label x and y axis</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (hr)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Concentration (M)&#39;</span><span class="p">)</span>

<span class="c1"># create plot title</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Aspirin Hydrolysis in an Aqueous Solution at pH 7.0 and 37 C&#39;</span><span class="p">)</span>

<span class="c1"># set x and y axis limits</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>

<span class="c1"># set y-axis to logarithmic scale</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>

<span class="c1"># create legend</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/2b0aca5cd89f5e43fdf725600478b59d89719b04bfcf74512c9a7061beee24b7.png" src="_images/2b0aca5cd89f5e43fdf725600478b59d89719b04bfcf74512c9a7061beee24b7.png" />
</div>
</div>
<p>Rather than taking the log of the underlying data, this simply changes the visualization, while creating log-spaced tick marks.</p>
<p>From this plot, we can see that the linear (apparent) decrease in the aspirin concentration on a semi-log plot indicates that it’s hydrolysis obeys a first-order rate law. However, the salicyclic acid data in this plot appears to behaves strangely. This is because it, instead, starting from zero concentration before rising as <span class="math notranslate nohighlight">\(A(1-e^{-t / 	\tau})\)</span> so we’d need to think a bit harder to either manipulate the data, or generate custom plot axes to highlight this relationship. (We’ll leave aside for a moment any additional underlying dependencies in this reaction, for instance on pH!)</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "Rees9/Py4PhysChem",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="ManipulatingData.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Data Manipulation &amp; Analysis in Python</p>
      </div>
    </a>
    <a class="right-next"
       href="lmfit.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Best Fits in Python</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-in-python-matplotlib">Plotting in Python: matplotlib</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#annotating-your-plot-plt-annotate">Annotating your plot: plt.annotate()</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alternative-scale-plots-log-inverse-etc">Alternative scale plots: log, inverse, etc</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Rees Hughes, Mark Wilson
</p>

  </div>
  
  <div class="footer-item">
    

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  <div>
<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/"><img src="https://licensebuttons.net/l/by-nc-sa/3.0/88x31.png"></a>
    All content on this site (unless otherwise specified) is licensed under the <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0 license</a>
</div>

</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>